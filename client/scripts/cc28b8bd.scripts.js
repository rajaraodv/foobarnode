function HeaderCtrl(a,b,c,d){c.appUser=b.get(),a.$watch("appUser",function(){a.loginText=a.appUser.username?"Logged in as "+a.appUser.username:"Log In",c.loggedIn=a.appUser.username?!0:!1},!0),a.logout=function(){c.appUser="",d.path("/")}}function MainCtrl(a,b,c){a.photoPosts=[],a.page=1,a.limit=10,a.noMorePosts=!1,a.loadPhotoPosts=function(){if(a.noMorePosts)return;var b={method:"GET",url:"/feeds/"+a.page+"/"+a.limit,data:null,headers:null},d=c(b);d.success(function(b){if(b instanceof Array){if(b.length===0){a.noMorePosts=!0;return}a.photoPosts=a.photoPosts.concat(b),a.page+=1}}),d.error(function(b){a.noMorePosts=!0,alert(b.Error)})},a.loadPhotoPosts(),a.container=$("#photoContainer"),a.container.imagesLoaded(function(){a.container.masonry({itemSelector:".photo"})}),a.toggleLikeBtnName=function(b){return $.inArray(a.appUser._id,b.liked_by)>=0?"Unlike":"Like"},a.toggleLikeBtnIcon=function(b){return $.inArray(a.appUser._id,b.liked_by)>=0?"icon-thumbs-down":"icon-thumbs-up"},a.pluralizeLikes={0:"",one:"{} like",other:"{} likes"},a.pluralizeComments={0:"",one:"{} comment",other:"{} comments"},a.toggleLike=function(b){if(!a.loggedIn)return;var d,e=$.inArray(a.appUser._id,b.liked_by)>=0;e?d={method:"DELETE",url:"/likes/photoposts/"+b._id,data:null,headers:{"X-foobar-username":a.appUser.username,"X-foobar-access-token":a.appUser.access_token}}:d={method:"POST",url:"/likes",data:{post_id:b._id},headers:{"Content-Type":"application/json","X-foobar-username":a.appUser.username,"X-foobar-access-token":a.appUser.access_token}};var f=c(d);f.success(function(){e?(b.likes_cnt=b.likes_cnt-1,b.liked_by.splice($.inArray(a.appUser._id,b.liked_by),1)):(b.likes_cnt=b.likes_cnt+1,b.liked_by.push(a.appUser._id))}),f.error(function(a){alert(a.Error)})},a.deleteComment=function(b,d){if(!a.loggedIn||d.creator._id!==a.appUser._id)return;var e={method:"DELETE",url:"/comments/"+d._id,data:null,headers:{"X-foobar-username":a.appUser.username,"X-foobar-access-token":a.appUser.access_token}},f=c(e);f.success(function(){var a=-1;for(var c in b.comments){if(!b.comments.hasOwnProperty(c))continue;a++;if(b.comments[c]._id===d._id)break}b.comments.splice(a,1),b.comments_cnt=b.comments_cnt-1}),f.error(function(a){alert(a.Error)})},a.addComment=function(b){if(!a.loggedIn||!b.newComment||b.newComment==="")return;var d={method:"POST",url:"/comments",data:{post_id:b._id,text:b.newComment},headers:{"Content-Type":"application/json","X-foobar-username":a.appUser.username,"X-foobar-access-token":a.appUser.access_token}},e=c(d);e.success(function(a){b.newComment="",b.comments_cnt=b.comments_cnt+1,b.comments.push(a)}),e.error(function(a){alert(a.Error)})},a.showCommentField=function(){if(!a.loggedIn)return;a.cf=!0}}function ShareCtrl(a){console.log(1),a.gclick=function(){var a=window.open("https://plusone.google.com/_/+1/confirm?hl=en-US&url=http://foobarnode.cloudfoundry.com/","popupwindow","scrollbars=yes,width=800,height=400");return a.focus(),!1},a.fbsClick=function(){var a=location.href,b=document.title;return window.open("http://www.facebook.com/sharer.php?u="+encodeURIComponent(a)+"&t="+encodeURIComponent(b),"sharer","toolbar=0,status=0,width=626,height=436"),!1},a.twtClick=function(){var a=window.open("https://twitter.com/intent/tweet?text=Check out the Foo Bar from Cloud Foundry http://foobarnode.cloudfoundry.com","name","height=435,width=600");return window.focus&&a.focus(),!1}}function GalleryCtrl(a,b){}"use strict";var clientAppModule=angular.module("clientApp",["ngResource"]);clientAppModule.config(["$routeProvider",function(a){a.when("/",{controller:MainCtrl,templateUrl:"views/main.html"}).when("/gallery",{controller:MainCtrl,templateUrl:"views/main.html"}).otherwise({redirectTo:"/"})}]),clientAppModule.directive("showonhoverparent",function(){return{link:function(a,b){b.parent().bind("mouseenter",function(){b.show()}),b.parent().bind("mouseleave",function(){b.hide()})}}}),clientAppModule.directive("toggleDeleteComment",function(){return{link:function(a,b){b.bind("mouseenter",function(){if(a.comment.creator._id!==a.appUser._id)return;b.find(".deleteComment").show()}),b.bind("mouseleave",function(){b.find(".deleteComment").hide()})}}}),clientAppModule.directive("togglecommentfield",function(){return{link:function(a,b){b.bind("click",function(){if(!a.loggedIn)return;var c=b.parent().find(".commentWrap");c.toggle(),c.find(".c11").focus(),a.container.masonry("reload")})}}}),clientAppModule.directive("addTwtrWidget",function(){return{link:function(a,b){a.loadTwitWidget=new window.TWTR.Widget({id:"twitter_widget_div",version:2,type:"search",search:"cloudfoundry, vmware",interval:2e4,title:"",subject:"",width:150,height:700,theme:{shell:{background:"#ffffff",color:"#eeeeee"},tweets:{background:"#ffffff",color:"#444444",links:"#0a96c5"}},features:{scrollbar:!1,loop:!0,live:!0,hashtags:!0,timestamp:!0,avatars:!0,toptweets:!0,behavior:"default"}}),a.loadTwitWidget.render().start(),b.bind("destroy",function(){a.loadTwitWidget.stop()})}}}),clientAppModule.factory("PhotoPostService",["$resource","$rootScope",function(a,b){var c=a("/feeds/1/10",null,{query:{method:"GET",isArray:!0,headers:{"X-foobar-username":b.appUser.username,"X-foobar-access-token":b.appUser.access_token}}});return c}]),clientAppModule.factory("LikesService",["$resource",function(a){var b=a("scripts/mocks/like.json");return b}]),clientAppModule.factory("LoginService",["$resource",function(a){var b=a("/session/user");return b}]),clientAppModule.directive("addMasonry",["$timeout",function(a){return{restrict:"A",link:function(b){a(function(){b.container.imagesLoaded(function(){b.container.masonry("reload")})},0)}}}]),clientAppModule.directive("loginRequired",["$anchorScroll",function(a){var b={link:function(b,c){function d(){if(b.loggedIn)return;a();var c=angular.element("#loginRequiredDialog");c.modal("show")}c.bind("click",d)}};return b}]),clientAppModule.directive("whenScrolled",function(){return function(a,b,c){var d=b[0];b.bind("scroll",function(){d.scrollTop+d.offsetHeight>=d.scrollHeight&&a.$apply(c.whenScrolled)})}}),"use strict",HeaderCtrl.$inject=["$scope","LoginService","$rootScope","$location"],"use strict",MainCtrl.$inject=["$scope","PhotoPostService","$http"],"use strict",ShareCtrl.$inject=["$scope"],"use strict",GalleryCtrl.$inject=["$scope","$location"];